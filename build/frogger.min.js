var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},FroggerJS;!function(e){e.Constants={TILE_SIZE:120,WINDOW_WIDTH:1560,WINDOW_HEIGHT:1200,DISPLAY_BOUNDING:!0},e.Levels=[[{texture:"grass-water-top",touchAllowed:!0},{texture:"water",touchAllowed:!1,mobile:{type:"boat",orientation:"right",speed:1}},{texture:"water",touchAllowed:!1,mobile:{type:"boat",orientation:"left",speed:1.5}},{texture:"water",touchAllowed:!1,mobile:{type:"boat",orientation:"right",speed:1}},{texture:"grass-water-bottom",touchAllowed:!0},{texture:"road-top",touchAllowed:!0,mobile:{type:"car",orientation:"left",speed:1}},{texture:"road-middle-top",touchAllowed:!0,mobile:{type:"car",orientation:"left",speed:1.5}},{texture:"road-middle-bottom",touchAllowed:!0,mobile:{type:"car",orientation:"right",speed:1.5}},{texture:"road-bottom",touchAllowed:!0,mobile:{type:"car",orientation:"right",speed:1}},{texture:"grass",touchAllowed:!0}]]}(FroggerJS||(FroggerJS={}));var Utils;!function(e){var t=function(){function e(){this.handlers=[]}return e.prototype.register=function(e){this.handlers.push(e)},e.prototype.unregister=function(e){this.handlers=this.handlers.filter(function(t){return t!==e})},e.prototype.invoke=function(e){this.handlers.slice(0).forEach(function(t){return t(e)})},e}();e.Event=t}(Utils||(Utils={}));var FroggerJS;!function(e){var t;!function(e){var t=Utils.Event,i=function(){function e(e){this.onLoadingCompleted=new t,this.loader=PIXI.loader,this.baseResourcesPath=e;var i=this;this.loader.once("complete",function(){i.onLoadingCompleted.invoke()})}return e.prototype.register=function(e){if(e instanceof Array)for(var t=0;t<e.length;++t)this.registerSingleElement(e[t]);else this.registerSingleElement(e)},e.prototype.get=function(e){if(!this.loader.resources[e])throw'ERROR: The "'+e+"\" doesn't exist in the resources.";return this.loader.resources[e].texture},e.prototype.load=function(){this.loader.load()},e.prototype.registerSingleElement=function(e){this.loader.add(e,this.baseResourcesPath+"/"+e+".png")},e}();e.ImageLoader=i}(t=e.Graphics||(e.Graphics={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(e){var t;!function(e){var t=Utils.Event,i=function(){function e(e,i){this.onRender=new t,this.width=e,this.height=i,this.stage=new PIXI.Container,this.renderer=PIXI.autoDetectRenderer(e,i,{resolution:window.devicePixelRatio}),this.resize(),document.body.appendChild(this.renderer.view),window.addEventListener("resize",this.resize.bind(this))}return e.prototype.addChild=function(e){var t=e instanceof PIXI.DisplayObject?e:e.getDisplayObject();this.stage.addChild(t)},e.prototype.removeChild=function(e){var t=e instanceof PIXI.DisplayObject?e:e.getDisplayObject();this.stage.removeChild(t)},e.prototype.render=function(){function e(){requestAnimationFrame(e),t.onRender.invoke(),t.renderer.render(t.stage)}var t=this;e()},e.prototype.resize=function(){var e=Math.min(window.innerWidth/this.width,window.innerHeight/this.height);this.stage.scale.x=this.stage.scale.y=e,this.renderer.resize(Math.ceil(this.width*e),Math.ceil(this.height*e))},e}();e.Scene=i}(t=e.Graphics||(e.Graphics={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Up=0]="Up",e[e.Left=3*Math.PI/2]="Left",e[e.Down=Math.PI]="Down",e[e.Right=Math.PI/2]="Right"}(e.Orientation||(e.Orientation={}));var t=e.Orientation,i=function(){function e(){}return e.fromStringToOrientation=function(e){switch(e.toLowerCase()){case"up":return t.Up;case"left":return t.Left;case"down":return t.Down;case"right":return t.Right}throw"ERROR: Invalid orientation string specified."},e}();e.OrientationUtils=i}(t=e.Objects||(e.Objects={}))}(t=e.Game||(e.Game={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(e){var t;!function(e){var t=function(){function t(e,t){this.center=e,this.radius=t}return t.prototype.getCenter=function(){return this.center},t.prototype.getRadius=function(){return this.radius},t.prototype.isCollide=function(i){if(i instanceof e.RectangleBounding){var o=i.getWidth()/2,n=i.getHeight()/2,r=Math.abs(this.center.x-i.getTop().x-o),s=Math.abs(this.center.y-i.getTop().y-n);if(r>o+this.radius)return!1;if(s>n+this.radius)return!1;if(r<=o)return!0;if(s<=n)return!0;var a=r-o,h=s-n;return a*a+h*h<=this.radius*this.radius}if(i instanceof t){var a=this.center.x-i.getCenter().x,h=this.center.y-i.getCenter().y,g=Math.sqrt(a*a+h*h);return g<this.radius+i.getRadius()}throw"ERROR: Unknown bounding."},t.prototype.getDisplayObject=function(){var e=new PIXI.Graphics;return e.position=this.center,e.alpha=.5,e.beginFill(16711680),e.drawCircle(0,0,this.radius),e.endFill(),e},t}();e.CircleBounding=t}(t=e.Physics||(e.Physics={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(e){var t;!function(t){var i;!function(t){var i,o=e.Physics.CircleBounding;!function(e){e[e.Up=38]="Up",e[e.Down=40]="Down",e[e.Left=37]="Left",e[e.Right=39]="Right"}(i||(i={}));var n=function(){function n(n){this.tilePosition=0,this.deltaPosition=void 0,this.keyUpTexture=n.get("frog"),this.keyDownTexture=n.get("frog-extend"),this.sprite=new PIXI.Sprite(this.keyUpTexture),this.sprite.anchor=new PIXI.Point(.5,.5);var r=.3;this.bounding=new o(this.sprite.position,this.sprite.width*r);var s=this;this.onKeyDown=function(e){var o;switch(e.keyCode){case i.Left:o=t.Orientation.Left;break;case i.Up:o=t.Orientation.Up;break;case i.Right:o=t.Orientation.Right;break;case i.Down:o=t.Orientation.Down}s.sprite.rotation=o,s.sprite.texture=s.keyDownTexture},this.onKeyUp=function(t){var o=e.Constants.TILE_SIZE;switch(s.sprite.texture=s.keyUpTexture,t.keyCode){case i.Left:s.sprite.position.x-=o;break;case i.Up:s.sprite.position.y-=o;break;case i.Right:s.sprite.position.x+=o;break;case i.Down:s.sprite.position.y+=o}s.deltaPosition=void 0,t.keyCode!=i.Up&&t.keyCode!=i.Down||s.updateTilePosition()}}return n.removeOneLive=function(){if(--n.availableLives<0)throw"ERROR: Negative live count."},n.getAvailableLives=function(){return n.availableLives},n.setAvailableLives=function(e){n.availableLives=e},n.prototype.startPosition=function(){this.sprite.rotation=t.Orientation.Up,this.sprite.position.x=e.Constants.WINDOW_WIDTH/2,this.sprite.position.y=e.Constants.WINDOW_HEIGHT-this.sprite.height/2,this.updateTilePosition()},n.prototype.follow=function(e){this.deltaPosition||(this.deltaPosition=this.sprite.position.x-e.getDisplayObject().position.x),this.sprite.position.x=e.getDisplayObject().position.x+this.deltaPosition},n.prototype.getTilePosition=function(){return this.tilePosition},n.prototype.getDisplayObject=function(){return this.sprite},n.prototype.getBounding=function(){return this.bounding},n.prototype.updateTilePosition=function(){this.tilePosition=Math.floor(this.sprite.position.y/e.Constants.TILE_SIZE)},n.availableLives=5,n}();t.Frog=n}(i=t.Objects||(t.Objects={}))}(t=e.Game||(e.Game={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(e){var t;!function(e){var t=function(){function t(e,t,i){this.top=e,this.width=t,this.height=i}return t.prototype.getTop=function(){return this.top},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.isCollide=function(i){if(i instanceof t)return this.top.x<i.getTop().x+i.getWidth()&&this.top.x+this.width>i.getTop().x&&this.top.y<i.getTop().y+i.getHeight()&&this.height+this.top.y>i.getTop().y;if(i instanceof e.CircleBounding)return i.isCollide(this);throw"ERROR: Unknown bounding."},t.prototype.getDisplayObject=function(){var e=new PIXI.Graphics;return e.position=this.top,e.alpha=.5,e.beginFill(255),e.drawRect(0,0,this.width,this.height),e.endFill(),e},t}();e.RectangleBounding=t}(t=e.Physics||(e.Physics={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(e){var t;!function(t){var i;!function(t){var i=e.Physics.RectangleBounding,o=function(){function o(e,o,n){this.speedDecimal=0,this.sprite=e,this.orientation=o,this.speed=n,this.sprite.anchor=new PIXI.Point(.5,.5),this.sprite.rotation=o,this.sprite.anchor=o==t.Orientation.Right?new PIXI.Point(0,1):new PIXI.Point(1,0),this.bounding=new i(this.sprite.position,this.sprite.height,this.sprite.width)}return o.prototype.updatePosition=function(){var i=this.speed;this.speed%1!=0&&(this.speedDecimal+=this.speed,i=Math.floor(this.speedDecimal),this.speedDecimal=this.speedDecimal%1),this.sprite.position.x+=this.orientation==t.Orientation.Left?-i:i,this.sprite.position.x>e.Constants.WINDOW_WIDTH+this.sprite.height?this.sprite.position.x=-this.sprite.height:this.sprite.position.x<-this.sprite.height&&(this.sprite.position.x=e.Constants.WINDOW_WIDTH+this.sprite.height)},o.prototype.getDisplayObject=function(){return this.sprite},o.prototype.getBounding=function(){return this.bounding},o}();t.MobileObject=o}(i=t.Objects||(t.Objects={}))}(t=e.Game||(e.Game={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(e){var t;!function(e){var t;!function(e){var t=function(e){function t(i,o,n){var r=Math.floor(Math.random()*t.availableColors.length),s=new PIXI.Sprite(i.get(t.TYPE+"-"+t.availableColors[r]));e.call(this,s,o,n)}return __extends(t,e),t.prototype.isCollisionAccepted=function(){return!1},t.TYPE="car",t.availableColors=["blue","green","red","white"],t}(e.MobileObject);e.Car=t}(t=e.Objects||(e.Objects={}))}(t=e.Game||(e.Game={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(e){var t;!function(e){var t;!function(e){var t=function(e){function t(i,o,n){var r=Math.floor(Math.random()*t.availableColors.length),s=new PIXI.Sprite(i.get(t.TYPE+"-"+t.availableColors[r]));e.call(this,s,o,n)}return __extends(t,e),t.prototype.isCollisionAccepted=function(){return!0},t.TYPE="boat",t.availableColors=["red","yellow"],t}(e.MobileObject);e.Boat=t}(t=e.Objects||(e.Objects={}))}(t=e.Game||(e.Game={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(e){this.imageLoader=e}return t.prototype.createMobile=function(t,i,o){switch(t.toLowerCase()){case e.Car.TYPE:return new e.Car(this.imageLoader,i,o);case e.Boat.TYPE:return new e.Boat(this.imageLoader,i,o)}throw"ERROR: The mobile name doesn't exist."},t}();e.MobileFactory=t}(t=e.Objects||(e.Objects={}))}(t=e.Game||(e.Game={}))}(FroggerJS||(FroggerJS={}));var Utils;!function(e){!function(e){e[e.Debug=1]="Debug",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error"}(e.LogLevel||(e.LogLevel={}));var t=e.LogLevel,i=function(){function e(){}return e.logMessage=function(i,o){if(void 0===o&&(o=t.Debug),!(e.activeLogLevel>o))switch(o){case t.Debug:console.log("[DEBUG] "+i);break;case t.Info:console.info("[INFO] "+i);break;case t.Warning:console.warn("[WARNING] "+i);break;case t.Error:console.error("[ERROR] "+i)}},e.activeLogLevel=t.Debug,e}();e.Logger=i}(Utils||(Utils={}));var FroggerJS;!function(e){var t;!function(t){var i=e.Game.Objects.Frog,o=Utils.Event,n=Utils.Logger,r=e.Game.Objects.OrientationUtils,s=e.Game.Objects.MobileFactory,a=function(){function t(e,t){this.onGameOver=new o,this.onNextLevel=new o,this.scene=t,this.imageLoader=e,this.frog=new i(e),this.mobileFactory=new s(e),this.mobileObjects=[],this.touchAllowedStatus=[]}return t.prototype.setupLevel=function(t){n.logMessage("Initialize level "+t.level+"...");var i=e.Levels[0];if(i.length!=e.Constants.WINDOW_HEIGHT/e.Constants.TILE_SIZE)throw"ERROR: The level configuration isn't valid.";for(var o=e.Constants.WINDOW_WIDTH/e.Constants.TILE_SIZE,s=0;s<i.length;++s){if(!i[s].hasOwnProperty("texture"))throw"ERROR: Texture property is missing.";if(!i[s].hasOwnProperty("touchAllowed"))throw"ERROR: TouchAllowed property is missing.";this.touchAllowedStatus.push(i[s].touchAllowed);for(var a=this.imageLoader.get(i[s].texture),h=0;h<o;++h){var g=new PIXI.Sprite(a);g.position.x=h*e.Constants.TILE_SIZE,g.position.y=s*e.Constants.TILE_SIZE,this.scene.addChild(g)}if(this.mobileObjects[s]=[],i[s].hasOwnProperty("mobile")){var l=i[s].mobile;if(!l.hasOwnProperty("type"))throw"ERROR: Type property is missing.";if(!l.hasOwnProperty("orientation"))throw"ERROR: Orientation property is missing.";if(!l.hasOwnProperty("speed"))throw"ERROR: Speed property is missing.";var c=0,u=0,p=r.fromStringToOrientation(l.orientation);do{var d=this.mobileFactory.createMobile(l.type,p,l.speed),g=d.getDisplayObject();g.position.x=c,g.position.y=s*e.Constants.TILE_SIZE,u=g.height,c+=u+Math.floor(2.5*Math.random()*u+u),this.mobileObjects[s].push(d),this.scene.addChild(d)}while(c<e.Constants.WINDOW_WIDTH)}}if(this.frog.startPosition(),this.scene.addChild(this.frog),e.Constants.DISPLAY_BOUNDING){for(var s=0;s<this.mobileObjects.length;++s)for(var h=0;h<this.mobileObjects[s].length;++h)this.scene.addChild(this.mobileObjects[s][h].getBounding());this.scene.addChild(this.frog.getBounding())}document.addEventListener("keydown",this.frog.onKeyDown),document.addEventListener("keyup",this.frog.onKeyUp),this.scene.onRender.register(this.update.bind(this))},t.prototype.clearLevel=function(){document.removeEventListener("keydown",this.frog.onKeyDown),document.removeEventListener("keyup",this.frog.onKeyUp),this.scene.onRender.unregister(this.update)},t.prototype.update=function(){for(var e=0;e<this.mobileObjects.length;++e){for(var t=!1,i=0;i<this.mobileObjects[e].length;++i)if(this.mobileObjects[e][i].updatePosition(),this.frog.getTilePosition()==e){var o=this.mobileObjects[e][i];o.getBounding().isCollide(this.frog.getBounding())&&(t=!0,o.isCollisionAccepted()?this.frog.follow(o):this.restartLevel())}this.frog.getTilePosition()!=e||t||this.touchAllowedStatus[e]||this.restartLevel()}},t.prototype.restartLevel=function(){i.removeOneLive(),this.frog.startPosition();var e=i.getAvailableLives();n.logMessage("One live lost. "+e+" live(s) remaining."),e<=0&&this.onGameOver.invoke()},t}();t.GameManager=a}(t=e.Game||(e.Game={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(e){var t;!function(e){var t=function(){function e(){this.states={}}return e.prototype.register=function(e,t){this.states[e]=t},e.prototype.change=function(e){if(!(e in this.states))throw"ERROR: The specified name for the state doesn't exist.";var t=this.states[e];this.currentState&&this.currentState.leaving(),this.currentState=t,this.currentState.entered()},e}();e.StateManager=t}(t=e.States||(e.States={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(e){var t;!function(e){var t=Utils.Logger,i=function(){function e(e){this.stateManager=e;var t=this;this.startGame=function(){t.stateManager.change("level1")}}return e.prototype.entered=function(){t.logMessage("Entered in 'Main Menu State'."),document.querySelector("#button").addEventListener("click",this.startGame)},e.prototype.leaving=function(){document.querySelector("#button").removeEventListener("click",this.startGame),t.logMessage("Leaving the 'Main Menu State'.")},e}();e.MainMenuState=i}(t=e.States||(e.States={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(e){var t;!function(e){var t=Utils.Logger,i=function(){function e(e,t,i){this.gameLevelManager=e,this.levelConfiguration=t,this.stateManager=i}return e.prototype.entered=function(){t.logMessage("Entered in 'Game Level "+this.levelConfiguration.level+" State'."),this.gameLevelManager.onGameOver.register(this.gameOverOccurred),this.gameLevelManager.onNextLevel.register(this.nextLevelOccurred),this.gameLevelManager.setupLevel(this.levelConfiguration)},e.prototype.leaving=function(){this.gameLevelManager.onGameOver.unregister(this.gameOverOccurred),this.gameLevelManager.onNextLevel.unregister(this.nextLevelOccurred),this.gameLevelManager.clearLevel(),t.logMessage("Leaving the 'Game Level "+this.levelConfiguration.level+" State'.")},e.prototype.gameOverOccurred=function(){this.stateManager.change("endGame")},e.prototype.nextLevelOccurred=function(){var e=this.levelConfiguration.level+1;this.levelConfiguration.levelsCount>=e?this.stateManager.change("endGame"):this.stateManager.change("level"+e)},e}();e.GameLevelState=i}(t=e.States||(e.States={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(e){var t;!function(e){var t=Utils.Logger,i=function(){function e(){}return e.prototype.entered=function(){t.logMessage("Entered in 'End Game State'.")},e.prototype.leaving=function(){t.logMessage("Leaving the 'End Game State'.")},e}();e.EndGameState=i}(t=e.States||(e.States={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(e){var t=e.Graphics.ImageLoader,i=e.Graphics.Scene,o=e.Game.GameManager,n=e.States.StateManager,r=e.States.MainMenuState,s=e.States.GameLevelState,a=e.States.EndGameState,h=Utils.Logger,g=Utils.LogLevel,l=function(){function l(){}return l.initialize=function(){h.activeLogLevel=g.Debug,PIXI.utils._saidHello=!0,h.logMessage("Initialize Frogger.js...",g.Info),h.logMessage("Loading resources...",g.Info);var c=new t("assets");c.register(l.resources),c.onLoadingCompleted.register(function(){h.logMessage("Resources loaded.",g.Info);var t=new i(e.Constants.WINDOW_WIDTH,e.Constants.WINDOW_HEIGHT),l=new o(c,t),u=new n;u.register("mainMenu",new r(u)),u.register("level1",new s(l,{level:1,levelsCount:2},u)),u.register("level2",new s(l,{level:2,levelsCount:2},u)),u.register("endGame",new a),u.change("mainMenu"),t.render()}),c.load()},l.resources=["boat-red","boat-yellow","car-blue","car-green","car-red","car-white","frog","frog-extend","grass","grass-water-top","grass-water-bottom","water","road-top","road-middle-top","road-middle-bottom","road-bottom"],l}();e.App=l}(FroggerJS||(FroggerJS={})),FroggerJS.App.initialize();
//# sourceMappingURL=frogger.min.js.map
