var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},FroggerJS;!function(t){t.Constants={TILE_SIZE:120,WINDOW_WIDTH:1560,WINDOW_HEIGHT:1200,DISPLAY_BOUNDING:!0},t.Levels=[[{texture:"grass-water-top",touchAllowed:!0},{texture:"water",touchAllowed:!1,mobile:{type:"boat",orientation:"right",speed:1}},{texture:"water",touchAllowed:!1,mobile:{type:"boat",orientation:"left",speed:1.5}},{texture:"water",touchAllowed:!1,mobile:{type:"boat",orientation:"right",speed:1}},{texture:"grass-water-bottom",touchAllowed:!0},{texture:"road-top",touchAllowed:!0,mobile:{type:"car",orientation:"left",speed:1}},{texture:"road-middle-top",touchAllowed:!0,mobile:{type:"car",orientation:"left",speed:1.5}},{texture:"road-middle-bottom",touchAllowed:!0,mobile:{type:"car",orientation:"right",speed:1.5}},{texture:"road-bottom",touchAllowed:!0,mobile:{type:"car",orientation:"right",speed:1}},{texture:"grass",touchAllowed:!0}]]}(FroggerJS||(FroggerJS={}));var Utils;!function(t){var e=function(){function t(){this.handlers=[]}return t.prototype.register=function(t){this.handlers.push(t)},t.prototype.unregister=function(t){this.handlers=this.handlers.filter(function(e){return e!==t})},t.prototype.invoke=function(t){this.handlers.slice(0).forEach(function(e){return e(t)})},t}();t.Event=e}(Utils||(Utils={}));var FroggerJS;!function(t){var e;!function(t){var e=Utils.Event,i=function(){function t(t){this.onLoadingCompleted=new e,this.loader=PIXI.loader,this.baseResourcesPath=t;var i=this;this.loader.once("complete",function(){i.onLoadingCompleted.invoke()})}return t.prototype.register=function(t){if(t instanceof Array)for(var e=0;e<t.length;++e)this.registerSingleElement(t[e]);else this.registerSingleElement(t)},t.prototype.get=function(t){if(!this.loader.resources[t])throw'ERROR: The "'+t+"\" doesn't exist in the resources.";return this.loader.resources[t].texture},t.prototype.load=function(){this.loader.load()},t.prototype.registerSingleElement=function(t){this.loader.add(t,this.baseResourcesPath+"/"+t+".png")},t}();t.ImageLoader=i}(e=t.Graphics||(t.Graphics={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(t){var e;!function(t){var e=function(){function t(){this.ticker=PIXI.ticker.shared,this.ticker.autoStart=!1,this.ticker.stop()}return t.prototype.register=function(t){this.ticker.add(t.update,t)},t.prototype.unregister=function(t){this.ticker.remove(t.update,t)},t.prototype.start=function(){this.ticker.start()},t.prototype.stop=function(){this.ticker.stop()},t}();t.Ticker=e}(e=t.Graphics||(t.Graphics={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(t){var e;!function(t){var e=function(){function t(t,e){this.width=t,this.height=e,this.stage=new PIXI.Container,this.renderer=PIXI.autoDetectRenderer(t,e,{resolution:window.devicePixelRatio}),this.resize(),document.body.appendChild(this.renderer.view),window.addEventListener("resize",this.resize.bind(this))}return t.prototype.addChild=function(t){t instanceof PIXI.DisplayObject?this.stage.addChild(t):this.stage.addChild(t.getDisplayObject())},t.prototype.removeChild=function(t){t instanceof PIXI.DisplayObject?this.stage.removeChild(t):this.stage.removeChild(t.getDisplayObject())},t.prototype.clear=function(){this.stage.removeChildren()},t.prototype.update=function(t){this.renderer.render(this.stage)},t.prototype.resize=function(){var t=Math.min(window.innerWidth/this.width,window.innerHeight/this.height);this.stage.scale.x=this.stage.scale.y=t,this.renderer.resize(Math.ceil(this.width*t),Math.ceil(this.height*t))},t}();t.Scene=e}(e=t.Graphics||(t.Graphics={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(t){var e;!function(e){var i;!function(e){var i=function(){function e(t,e){if(this.speedDecimal=0,e=e.toLowerCase(),"left"!=e&&"right"!=e)throw"ERROR: Invalid orientation specified";this.speed=t,this.orientation=e}return e.prototype.update=function(e){this.speedDecimal+=this.speed*e;var i=Math.floor(this.speedDecimal);this.speedDecimal=this.speedDecimal%1;var o=this.getDisplayObject();o.position.x+="left"==this.orientation?-i:i,o.position.x>t.Constants.WINDOW_WIDTH+o.width?o.position.x=-o.width:o.position.x<-o.width&&(o.position.x=t.Constants.WINDOW_WIDTH+o.width)},e}();e.Mobile=i}(i=e.Objects||(e.Objects={}))}(e=t.Game||(t.Game={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(t){var e;!function(t){var e=function(){function e(t,e){this.center=t,this.radius=e}return e.prototype.getCenter=function(){return this.center},e.prototype.getRadius=function(){return this.radius},e.prototype.isCollide=function(i){if(i instanceof t.RectangleBounding){var o=i.getWidth()/2,r=i.getHeight()/2,n=Math.abs(this.center.x-i.getTop().x-o),s=Math.abs(this.center.y-i.getTop().y-r);if(n>o+this.radius)return!1;if(s>r+this.radius)return!1;if(n<=o)return!0;if(s<=r)return!0;var a=n-o,h=s-r;return a*a+h*h<=this.radius*this.radius}if(i instanceof e){var a=this.center.x-i.getCenter().x,h=this.center.y-i.getCenter().y,g=Math.sqrt(a*a+h*h);return g<this.radius+i.getRadius()}throw"ERROR: Unknown bounding."},e.prototype.getDisplayObject=function(){var t=new PIXI.Graphics;return t.position=this.center,t.alpha=.5,t.beginFill(16711680),t.drawCircle(0,0,this.radius),t.endFill(),t},e}();t.CircleBounding=e}(e=t.Physics||(t.Physics={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(t){var e;!function(e){var i,o=t.Physics.CircleBounding;!function(t){t[t.Up=38]="Up",t[t.Down=40]="Down",t[t.Left=37]="Left",t[t.Right=39]="Right"}(i||(i={}));var r;!function(t){t[t.Up=0]="Up",t[t.Left=3*Math.PI/2]="Left",t[t.Down=Math.PI]="Down",t[t.Right=Math.PI/2]="Right"}(r||(r={}));var n=function(){function e(e){this.tilePosition=void 0,this.deltaPosition=void 0,this.keyUpTexture=e.get("frog"),this.keyDownTexture=e.get("frog-extend"),this.sprite=new PIXI.Sprite(this.keyUpTexture),this.sprite.anchor=new PIXI.Point(.5,.5);var n=.3;this.bounding=new o(this.sprite.position,this.sprite.width*n);var s=this;this.onKeyDown=function(t){var e;switch(t.keyCode){case i.Left:e=r.Left;break;case i.Up:e=r.Up;break;case i.Right:e=r.Right;break;case i.Down:e=r.Down}s.sprite.rotation=e,s.sprite.texture=s.keyDownTexture},this.onKeyUp=function(e){var o=t.Constants.TILE_SIZE;switch(s.sprite.texture=s.keyUpTexture,e.keyCode){case i.Left:s.sprite.position.x-=o;break;case i.Up:s.sprite.position.y-=o;break;case i.Right:s.sprite.position.x+=o;break;case i.Down:s.sprite.position.y+=o}s.deltaPosition=void 0,e.keyCode!=i.Up&&e.keyCode!=i.Down||s.updateTilePosition()}}return e.removeOneLive=function(){if(--e.availableLives<0)throw"ERROR: Negative live count."},e.getAvailableLives=function(){return e.availableLives},e.setAvailableLives=function(t){if(t<0)throw"ERROR: Negative live count.";e.availableLives=t},e.prototype.startPosition=function(){this.sprite.rotation=r.Up,this.sprite.position.x=t.Constants.WINDOW_WIDTH/2,this.sprite.position.y=t.Constants.WINDOW_HEIGHT-this.sprite.height/2,this.updateTilePosition()},e.prototype.follow=function(t){this.deltaPosition||(this.deltaPosition=this.sprite.position.x-t.getDisplayObject().position.x),this.sprite.position.x=t.getDisplayObject().position.x+this.deltaPosition},e.prototype.getTilePosition=function(){return this.tilePosition},e.prototype.getDisplayObject=function(){return this.sprite},e.prototype.getBounding=function(){return this.bounding},e.prototype.updateTilePosition=function(){this.tilePosition=Math.floor(this.sprite.position.y/t.Constants.TILE_SIZE)},e.availableLives=5,e}();e.Actor=n}(e=t.Game||(t.Game={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(t){var e;!function(t){var e=function(){function e(t,e,i){this.top=t,this.width=e,this.height=i}return e.prototype.getTop=function(){return this.top},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.isCollide=function(i){if(i instanceof e)return this.top.x<i.getTop().x+i.getWidth()&&this.top.x+this.width>i.getTop().x&&this.top.y<i.getTop().y+i.getHeight()&&this.height+this.top.y>i.getTop().y;if(i instanceof t.CircleBounding)return i.isCollide(this);throw"ERROR: Unknown bounding."},e.prototype.getDisplayObject=function(){var t=new PIXI.Graphics;return t.position=this.top,t.alpha=.5,t.beginFill(255),t.drawRect(0,0,this.width,this.height),t.endFill(),t},e}();t.RectangleBounding=e}(e=t.Physics||(t.Physics={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(t){var e;!function(e){var i;!function(e){var i=t.Physics.RectangleBounding,o=function(t){function e(o,r,n){t.call(this,n,r);var s=Math.floor(Math.random()*e.availableColors.length),a=o.get(e.TYPE+"-"+e.availableColors[s]+"-"+r);this.sprite=new PIXI.Sprite(a),this.bounding=new i(this.sprite.position,this.sprite.width,this.sprite.height)}return __extends(e,t),e.prototype.getDisplayObject=function(){return this.sprite},e.prototype.getBounding=function(){return this.bounding},e.prototype.canBeHit=function(){return!1},e.TYPE="car",e.availableColors=["blue","green","red","white"],e}(e.Mobile);e.Car=o}(i=e.Objects||(e.Objects={}))}(e=t.Game||(t.Game={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(t){var e;!function(e){var i;!function(e){var i=t.Physics.RectangleBounding,o=function(t){function e(o,r,n){t.call(this,n,r);var s=Math.floor(Math.random()*e.availableColors.length),a=o.get(e.TYPE+"-"+e.availableColors[s]+"-"+r);this.sprite=new PIXI.Sprite(a),this.bounding=new i(this.sprite.position,this.sprite.width,this.sprite.height)}return __extends(e,t),e.prototype.getDisplayObject=function(){return this.sprite},e.prototype.getBounding=function(){return this.bounding},e.prototype.canBeHit=function(){return!0},e.TYPE="boat",e.availableColors=["red","yellow"],e}(e.Mobile);e.Boat=o}(i=e.Objects||(e.Objects={}))}(e=t.Game||(t.Game={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(t){var e;!function(t){var e;!function(t){var e=function(){function e(t){this.imageLoader=t}return e.prototype.createMobile=function(e,i,o){switch(e.toLowerCase()){case t.Car.TYPE:return new t.Car(this.imageLoader,i,o);case t.Boat.TYPE:return new t.Boat(this.imageLoader,i,o)}throw"ERROR: The mobile name doesn't exist."},e}();t.MobileFactory=e}(e=t.Objects||(t.Objects={}))}(e=t.Game||(t.Game={}))}(FroggerJS||(FroggerJS={}));var Utils;!function(t){!function(t){t[t.Debug=1]="Debug",t[t.Info=2]="Info",t[t.Warning=3]="Warning",t[t.Error=4]="Error"}(t.LogLevel||(t.LogLevel={}));var e=t.LogLevel,i=function(){function t(){}return t.logMessage=function(i,o){if(void 0===o&&(o=e.Debug),!(t.activeLogLevel>o))switch(o){case e.Debug:console.log("[DEBUG] "+i);break;case e.Info:console.info("[INFO] "+i);break;case e.Warning:console.warn("[WARNING] "+i);break;case e.Error:console.error("[ERROR] "+i)}},t.activeLogLevel=e.Debug,t}();t.Logger=i}(Utils||(Utils={}));var FroggerJS;!function(t){var e;!function(e){var i=t.Game.Actor,o=Utils.Event,r=Utils.Logger,n=t.Game.Objects.MobileFactory,s=function(){function e(t,e){this.onGameOver=new o,this.onNextLevel=new o,this.imageLoader=t,this.scene=e,this.actor=new i(t),this.mobileObjectFactory=new n(t),this.mobileObjects=[],this.touchAllowedStatus=[]}return e.prototype.setupLevel=function(e){r.logMessage("Initialize level "+e.level+"...");var o=t.Levels[0];if(o.length!=t.Constants.WINDOW_HEIGHT/t.Constants.TILE_SIZE)throw"ERROR: The level configuration isn't valid.";for(var n=t.Constants.WINDOW_WIDTH/t.Constants.TILE_SIZE,s=0;s<o.length;++s){if(!o[s].hasOwnProperty("texture"))throw"ERROR: Texture property is missing.";if(!o[s].hasOwnProperty("touchAllowed"))throw"ERROR: TouchAllowed property is missing.";this.touchAllowedStatus.push(o[s].touchAllowed);for(var a=this.imageLoader.get(o[s].texture),h=0;h<n;++h){var g=new PIXI.Sprite(a);g.position.x=h*t.Constants.TILE_SIZE,g.position.y=s*t.Constants.TILE_SIZE,this.scene.addChild(g)}if(this.mobileObjects[s]=[],o[s].hasOwnProperty("mobile")){var c=o[s].mobile;if(!c.hasOwnProperty("type"))throw"ERROR: Type property is missing.";if(!c.hasOwnProperty("orientation"))throw"ERROR: Rotation property is missing.";if(!c.hasOwnProperty("speed"))throw"ERROR: Speed property is missing.";var l=0,u=0;do{var p=this.mobileObjectFactory.createMobile(c.type,c.orientation,c.speed),g=p.getDisplayObject();g.position.x=l,g.position.y=s*t.Constants.TILE_SIZE,u=g.width,l+=u+Math.floor(2.5*Math.random()*u+u),this.mobileObjects[s].push(p),this.scene.addChild(p)}while(l<t.Constants.WINDOW_WIDTH)}}if(this.actor.startPosition(),this.scene.addChild(this.actor),t.Constants.DISPLAY_BOUNDING){for(var s=0;s<this.mobileObjects.length;++s)for(var h=0;h<this.mobileObjects[s].length;++h)this.scene.addChild(this.mobileObjects[s][h].getBounding());this.scene.addChild(this.actor.getBounding())}var d=new PIXI.Text(i.getAvailableLives());d.x=30,d.y=90,this.scene.addChild(d),document.addEventListener("keydown",this.actor.onKeyDown),document.addEventListener("keyup",this.actor.onKeyUp)},e.prototype.clearLevel=function(){document.removeEventListener("keydown",this.actor.onKeyDown),document.removeEventListener("keyup",this.actor.onKeyUp)},e.prototype.update=function(t){for(var e=0;e<this.mobileObjects.length;++e){for(var i=!1,o=0;o<this.mobileObjects[e].length;++o)if(this.mobileObjects[e][o].update(t),this.actor.getTilePosition()==e){var r=this.mobileObjects[e][o];r.getBounding().isCollide(this.actor.getBounding())&&(i=!0,r.canBeHit()?this.actor.follow(r):this.restartLevel())}this.actor.getTilePosition()!=e||i||this.touchAllowedStatus[e]||this.restartLevel()}},e.prototype.restartLevel=function(){i.removeOneLive(),this.actor.startPosition();var t=i.getAvailableLives();r.logMessage("One live lost. "+t+" live(s) remaining."),t<=0&&this.onGameOver.invoke()},e}();e.GameManager=s}(e=t.Game||(t.Game={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(t){var e;!function(t){var e=function(){function t(){this.states={}}return t.prototype.register=function(t,e){this.states[t]=e},t.prototype.change=function(t){if(!(t in this.states))throw"ERROR: The specified name for the state doesn't exist.";var e=this.states[t];this.currentState&&this.currentState.leaving(),this.currentState=e,this.currentState.entered()},t}();t.StateManager=e}(e=t.States||(t.States={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(t){var e;!function(t){var e=Utils.Logger,i=function(){function t(t){this.stateManager=t;var e=this;this.startGame=function(){e.stateManager.change("level1")}}return t.prototype.entered=function(){e.logMessage("Entered in 'Main Menu State'."),document.querySelector("#button").addEventListener("click",this.startGame)},t.prototype.leaving=function(){document.querySelector("#button").removeEventListener("click",this.startGame),e.logMessage("Leaving the 'Main Menu State'.")},t}();t.MainMenuState=i}(e=t.States||(t.States={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(t){var e;!function(t){var e=Utils.Logger,i=function(){function t(t,e,i,o){this.gameManager=t,this.levelConfiguration=e,this.ticker=i,this.stateManager=o}return t.prototype.entered=function(){e.logMessage("Entered in 'Game Level "+this.levelConfiguration.level+" State'."),this.gameManager.onGameOver.register(this.gameOverOccurred),this.gameManager.onNextLevel.register(this.nextLevelOccurred),this.gameManager.setupLevel(this.levelConfiguration),this.ticker.register(this.gameManager)},t.prototype.leaving=function(){this.ticker.unregister(this.gameManager),this.gameManager.onGameOver.unregister(this.gameOverOccurred),this.gameManager.onNextLevel.unregister(this.nextLevelOccurred),this.gameManager.clearLevel(),e.logMessage("Leaving the 'Game Level "+this.levelConfiguration.level+" State'.")},t.prototype.gameOverOccurred=function(){this.stateManager.change("endGame")},t.prototype.nextLevelOccurred=function(){var t=this.levelConfiguration.level+1;this.levelConfiguration.levelsCount>=t?this.stateManager.change("endGame"):this.stateManager.change("level"+t)},t}();t.GameLevelState=i}(e=t.States||(t.States={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(t){var e;!function(t){var e=Utils.Logger,i=function(){function t(){}return t.prototype.entered=function(){e.logMessage("Entered in 'End Game State'.")},t.prototype.leaving=function(){e.logMessage("Leaving the 'End Game State'.")},t}();t.EndGameState=i}(e=t.States||(t.States={}))}(FroggerJS||(FroggerJS={}));var FroggerJS;!function(t){var e=t.Graphics.ImageLoader,i=t.Graphics.Scene,o=t.Graphics.Ticker,r=t.Game.GameManager,n=t.States.StateManager,s=t.States.MainMenuState,a=t.States.GameLevelState,h=t.States.EndGameState,g=Utils.Logger,c=Utils.LogLevel,l=function(){function l(){}return l.initialize=function(){g.activeLogLevel=c.Debug,PIXI.utils._saidHello=!0,g.logMessage("Initialize Frogger.js...",c.Info),g.logMessage("Loading resources...",c.Info);var u=new e("assets");u.register(l.resources),u.onLoadingCompleted.register(function(){g.logMessage("Resources loaded.",c.Info);var e=new o,l=new i(t.Constants.WINDOW_WIDTH,t.Constants.WINDOW_HEIGHT),p=new r(u,l),d=new n;d.register("mainMenu",new s(d)),d.register("level1",new a(p,{level:1,levelsCount:2},e,d)),d.register("level2",new a(p,{level:2,levelsCount:2},e,d)),d.register("endGame",new h),d.change("mainMenu"),e.register(l),e.start()}),u.load()},l.resources=["boat-red-left","boat-red-right","boat-yellow-left","boat-yellow-right","car-blue-left","car-blue-right","car-green-left","car-green-right","car-red-left","car-red-right","car-white-left","car-white-right","frog","frog-extend","grass","grass-water-top","grass-water-bottom","water","road-top","road-middle-top","road-middle-bottom","road-bottom"],l}();t.App=l}(FroggerJS||(FroggerJS={})),FroggerJS.App.initialize();
//# sourceMappingURL=frogger.min.js.map
